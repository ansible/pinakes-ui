{"version":3,"file":"js/5132.e104f39af451f54e745f.js","mappings":"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","sources":["webpack:///./src/helpers/order/new-order-helper-s.ts","webpack:///./src/helpers/order/order-helper-s.ts","webpack:///./src/redux/actions/order-actions-s.tsx"],"sourcesContent":["// TODO migrate whole order-helper.js to TS\nimport catalogHistory from '../../routing/catalog-history';\nimport {\n  Order,\n  Portfolio,\n  ProgressMessage\n} from '@redhat-cloud-services/catalog-client';\nimport { Source } from '@redhat-cloud-services/sources-client';\nimport { getAxiosInstance } from '../shared/user-login';\nimport {\n  CATALOG_API_BASE,\n  CATALOG_INVENTORY_API_BASE\n} from '../../utilities/constants';\nimport { OrderItem } from './order-helper-s';\nconst axiosInstance = getAxiosInstance();\n\nexport interface ObjectNotFound {\n  object: 'Order item' | 'Product' | 'Portfolio' | 'Messages' | 'Platform';\n  notFound: boolean;\n}\nexport interface PortfolioItem {\n  id?: string;\n  favorite?: boolean;\n  name?: string;\n  description?: string | null;\n  orphan?: boolean;\n  state?: string;\n  long_description?: string | null;\n  distributor?: string | null;\n  documentation_url?: string | null;\n  support_url?: string | null;\n  owner?: string;\n  service_offering_source_ref?: string;\n  service_offering_type?: string;\n  portfolio?: string;\n  icon_url?: string;\n  created_at?: string;\n  updated_at?: string;\n  metadata?: any;\n}\n\nexport type OrderDetailPayload = [\n  Order,\n  OrderItem | ObjectNotFound,\n  PortfolioItem | ObjectNotFound,\n  Source | ObjectNotFound,\n  ProgressMessage | ObjectNotFound,\n  Portfolio | ObjectNotFound\n];\n\nexport type ProgressMessageItem = {\n  orderItemId: string;\n  progressMessages: ProgressMessage[];\n};\n\nexport interface OrderProvisionPayload {\n  orderItems: OrderItem[] | [];\n  progressMessageItems: ProgressMessageItem[] | [];\n}\n\nexport const fetchOrderDetailSequence = async (\n  orderId: string\n): Promise<OrderDetailPayload> => {\n  let order: Order;\n  try {\n    order = await axiosInstance.get(`${CATALOG_API_BASE}/orders/${orderId}/`);\n  } catch (error) {\n    order = {};\n    // @ts-ignore\n    if (error.status === 404 || error.status === 400) {\n      catalogHistory.replace({\n        pathname: '/404',\n        state: { from: catalogHistory.location }\n      });\n    } else {\n      throw error;\n    }\n  }\n\n  let orderItem: OrderItem | ObjectNotFound = {\n    object: 'Order item',\n    notFound: true\n  };\n  try {\n    const orderItems = await axiosInstance.get(\n      `${CATALOG_API_BASE}/order_items?order=${order.id}`\n    );\n    console.log('Debug - orderItems: ', orderItems);\n    orderItem = orderItems.results[0];\n  } catch (_error) {\n    // no handler\n  }\n\n  let portfolioItem: PortfolioItem | ObjectNotFound = {\n    object: 'Product',\n    notFound: true\n  };\n\n  try {\n    portfolioItem = await axiosInstance.get(\n      `${CATALOG_API_BASE}/portfolio_items/${\n        (orderItem as OrderItem).portfolio_item\n      }`\n    );\n  } catch (_error) {\n    // nohandler\n  }\n\n  console.log('Debug - portfolioItem: ', portfolioItem);\n  const parallerRequests = [\n    axiosInstance\n      .get(\n        `${CATALOG_INVENTORY_API_BASE}/sources/${\n          (portfolioItem as PortfolioItem).service_offering_source_ref\n        }`\n      )\n      .catch(() => ({ object: 'Platform', notFound: true })),\n\n    axiosInstance\n      .get(\n        `${CATALOG_API_BASE}/order_items/${\n          (orderItem as OrderItem).id\n        }/progress_messages/`\n      )\n      .catch(() => ({ object: 'Messages', notFound: true })),\n    axiosInstance\n      .get(\n        `${CATALOG_API_BASE}/portfolios/${\n          (portfolioItem as PortfolioItem).portfolio\n        }`\n      )\n      .catch(() => ({ object: 'Portfolio', notFound: true }))\n  ];\n\n  return Promise.all(\n    parallerRequests\n  ).then(([platform, progressMessages, portfolio]) => [\n    order,\n    orderItem,\n    portfolioItem,\n    platform as Source | ObjectNotFound,\n    progressMessages as ProgressMessage | ObjectNotFound,\n    portfolio as Portfolio | ObjectNotFound\n  ]);\n};\n\nexport const fetchOrderProvisionItems = async (\n  orderId: string\n): Promise<OrderProvisionPayload> => {\n  let orderItems: OrderItem[];\n  try {\n    const items = await axiosInstance.get(\n      `${CATALOG_API_BASE}/order_items/?order_id=${orderId}`\n    );\n    orderItems = items.data;\n  } catch (error) {\n    orderItems = [];\n    // @ts-ignore\n    if (error.status === 404 || error.status === 400) {\n      catalogHistory.replace({\n        pathname: '/404',\n        state: { from: catalogHistory.location }\n      });\n    } else {\n      throw error;\n    }\n  }\n\n  const progressMessageItems: ProgressMessageItem[] = [];\n  const promises = orderItems.map((orderItem) =>\n    axiosInstance\n      .get(`${CATALOG_API_BASE}/order_items/${orderItem.id}/progress_messages/`)\n      .then((item) => {\n        progressMessageItems.push({\n          orderItemId: orderItem.id || '',\n          progressMessages: item.data\n        });\n        return progressMessageItems;\n      })\n  );\n  await Promise.all(promises);\n  return { orderItems, progressMessageItems };\n};\n","/* eslint camelcase: 0 */\nimport { getAxiosInstance } from '../shared/user-login';\nimport {\n  CATALOG_API_BASE,\n  APPROVAL_API_BASE,\n  CATALOG_INVENTORY_API_BASE\n} from '../../utilities/constants';\nimport { defaultSettings } from '../shared/pagination';\nimport catalogHistory from '../../routing/catalog-history';\nimport {\n  fetchOrderDetailSequence,\n  fetchOrderProvisionItems,\n  OrderDetailPayload,\n  OrderProvisionPayload\n} from './new-order-helper-s';\nimport {\n  ApiCollectionResponse,\n  EnhancedOrder,\n  Full\n} from '../../types/common-types-s';\nimport {\n  ServicePlan,\n  Order,\n  PortfolioItem,\n  ApprovalRequest,\n  ProgressMessage\n} from '@redhat-cloud-services/catalog-client';\nimport { AxiosPromise } from 'axios';\nimport { AnyObject } from '@data-driven-forms/react-form-renderer';\nimport { Request, Action } from '@redhat-cloud-services/approval-client';\nimport { GetOrderDetailParams } from './order-helper';\nimport { OrderItemStateEnum } from '@redhat-cloud-services/catalog-client';\nimport { ApiMetadata } from '../../types/common-types';\n\nconst axiosInstance = getAxiosInstance();\n\nexport interface OrderItem {\n  id?: string;\n  name?: string;\n  count: number;\n  service_parameters?: any | null;\n  provider_control_parameters?: any | null;\n  portfolio_item: string;\n  state?: OrderItemStateEnum;\n  order?: string;\n  created_at?: string;\n  order_request_sent_at?: string;\n  completed_at?: string;\n  updated_at?: string;\n  owner?: string;\n  external_url?: string;\n  insights_request_id?: string;\n  process_sequence?: number;\n  process_scope?: string;\n  artifacts?: any;\n}\n\nexport const sendSubmitOrder = async (\n  {\n    service_parameters: { providerControlParameters, ...service_parameters },\n    ...parameters\n  }: AnyObject,\n  portfolioItem: AnyObject\n): Promise<EnhancedOrder> => {\n  const order: Order = await axiosInstance.post(`${CATALOG_API_BASE}/orders/`);\n  let orderItem: Partial<OrderItem> = {};\n  orderItem.count = 1;\n  orderItem = {\n    ...orderItem,\n    ...parameters,\n    service_parameters,\n    provider_control_parameters: providerControlParameters || {}\n  };\n  const orderItemResponse = await axiosInstance.post(\n    `${CATALOG_API_BASE}/orders/${order.id}/order_items/`,\n    {\n      id: order.id,\n      name: `orderItem_${order.id}`,\n      portfolio_item: portfolioItem.id,\n      ...orderItem\n    }\n  );\n  return axiosInstance\n    .post(`${CATALOG_API_BASE}/orders/${order.id}/submit/`)\n    .then((order) => ({\n      ...order,\n      orderItem: (orderItemResponse as unknown) as OrderItem\n    }));\n};\n\nexport const cancelOrder = (orderId: string): AxiosPromise<Order> =>\n  axiosInstance.post(`${CATALOG_API_BASE}/orders/${orderId}/cancel/`);\n\nconst getOrderItems = (\n  orderIds: string[]\n): Promise<ApiCollectionResponse<OrderItem>> =>\n  axiosInstance.get(\n    `${CATALOG_API_BASE}/order_items/?page-size=${orderIds.length * 3 ||\n      defaultSettings.limit}${orderIds.length ? '&' : ''}${orderIds\n      .map((orderId) => `order_id=${orderId}`)\n      .join('&')}`\n  );\n\nconst getOrderPortfolioItems = (\n  itemIds: string[]\n): Promise<ApiCollectionResponse<PortfolioItem>> =>\n  axiosInstance.get(\n    `${CATALOG_API_BASE}/portfolio_items/?${itemIds\n      .map((itemId) => `id=${itemId}`)\n      .join('&')}`\n  );\n\nexport const getOrdersS = (\n  filter = '',\n  pagination = defaultSettings\n): Promise<{\n  data: (Order & { orderItems: OrderItem[] })[];\n}> =>\n  axiosInstance.get(\n    `${CATALOG_API_BASE}/orders/${filter}${\n      filter?.length > 1 ? '&' : '?'\n    }page_size=${pagination.limit}&page=${pagination.offset || 1}`\n  );\n\nexport const getOrders = (\n  filter = '',\n  pagination = defaultSettings\n): Promise<{\n  data: (Order & { orderItems: OrderItem[] })[];\n  portfolioItems: ApiCollectionResponse<PortfolioItem>;\n}> =>\n  axiosInstance\n    .get(\n      `${CATALOG_API_BASE}/orders/${filter}${\n        filter?.length > 1 ? '&' : '?'\n      }page_size=${pagination.limit}&page=${pagination.offset || 1}`\n    ) // eslint-disable-line max-len\n    .then((orders: ApiCollectionResponse<Full<Order>>) => {\n      console.log('Debug - orders: ', orders);\n      return getOrderItems(orders.results.map(({ id }) => id)).then(\n        (orderItems) => {\n          console.log('Debug - orderItems: ', orderItems);\n          return getOrderPortfolioItems(\n            orderItems.results.map(({ portfolio_item }) => portfolio_item)\n          ).then((portfolioItems) => {\n            console.log('Debug - portfolioItems: ', portfolioItems);\n            return {\n              portfolioItems,\n              ...orders,\n              data: orders.results.map((orderObj) => ({\n                ...orderObj,\n                orderItems: orderItems.results.filter(\n                  ({ order }) => order === orderObj.id\n                )\n              }))\n            };\n          });\n        }\n      );\n    });\n\nexport const getOrderDetail = (\n  params: GetOrderDetailParams\n): Promise<OrderDetailPayload> => {\n  console.log('Debug - getOrderDetail - params: ', params);\n  if (Object.values(params).some((value) => !value)) {\n    /**\n     * Try to fetch data sequentially if any of the parameters is unknown\n     */\n    return fetchOrderDetailSequence(params.order);\n  }\n\n  const detailPromises = [\n    (axiosInstance\n      .get(`${CATALOG_API_BASE}/orders/${params.order}/`)\n      .catch((error) => {\n        if (error.status === 404 || error.status === 400) {\n          return catalogHistory.replace({\n            pathname: '/404',\n            state: { from: catalogHistory.location }\n          });\n        }\n\n        throw error;\n      }) as unknown) as Promise<Order>,\n    axiosInstance\n      .get(`${CATALOG_API_BASE}/order_items/${params['order-item']}/`)\n      .catch((error) => {\n        if (error.status === 404 || error.status === 400) {\n          return {\n            object: 'Order item',\n            notFound: true\n          };\n        }\n\n        throw error;\n      }),\n    axiosInstance\n      .get(`${CATALOG_API_BASE}/portfolio_items/${params['portfolio-item']}/`)\n      .catch((error) => {\n        if (error.status === 404 || error.status === 400) {\n          return {\n            object: 'Product',\n            notFound: true\n          };\n        }\n\n        throw error;\n      }),\n    axiosInstance\n      .get(`${CATALOG_INVENTORY_API_BASE}/sources/${params.platform}/`)\n      .catch((error) => {\n        if (error.status === 404 || error.status === 400) {\n          return {\n            object: 'Platform',\n            notFound: true\n          };\n        }\n\n        throw error;\n      }),\n    axiosInstance\n      .get(`${CATALOG_API_BASE}/orders/${params.order}/progress_messages/`)\n      .catch((error) => {\n        if (error.status === 404 || error.status === 400) {\n          return {};\n        }\n\n        throw error;\n      }),\n    axiosInstance\n      .get(`${CATALOG_API_BASE}/portfolios/${params.portfolio}/`)\n      .catch((error) => {\n        if (error.status === 404 || error.status === 400) {\n          return {\n            object: 'Portfolio',\n            notFound: true\n          };\n        }\n\n        throw error;\n      })\n  ];\n\n  return (Promise.all(detailPromises) as unknown) as Promise<\n    OrderDetailPayload\n  >;\n};\n\nconst APPROVAL_REQUESTER_PERSONA = 'approval/requester';\nexport interface RequestTranscript extends Full<Request> {\n  actions: Action[];\n}\nconst requestTranscriptQuery = (parent_id: string) => `query {\n  requests(id: \"${parent_id}\") {\n    id\n    number_of_children\n    decision\n    group_name\n    created_at\n    state\n    actions {\n      id\n      created_at\n    }\n    requests {\n      id\n      number_of_children\n      decision\n      group_name\n      state\n      parent_id\n      created_at\n      actions {\n        id\n        created_at\n      }\n    }\n  }\n}`;\nconst fetchRequestTranscript = (\n  requestId: string\n): Promise<RequestTranscript[]> =>\n  axiosInstance\n    .get(`${APPROVAL_API_BASE}/requests/${requestId}/`, {\n      'x-rh-persona': APPROVAL_REQUESTER_PERSONA\n    })\n    .then(({ data: { requests } }) => {\n      return requests &&\n        requests.length > 0 &&\n        requests[0].number_of_children > 0\n        ? requests[0].requests\n        : requests;\n    });\n\nexport const getApprovalRequests = (\n  orderItemId: string\n): Promise<{\n  data: { group_name: string; decision: string; updated?: string }[];\n}> =>\n  axiosInstance\n    .get(`${CATALOG_API_BASE}/order_items/${orderItemId}/approval_requests/`)\n    .then(({ data }: { data: Full<ApprovalRequest>[] }) => {\n      const promises = data.map(({ approval_request_ref }) =>\n        fetchRequestTranscript(approval_request_ref)\n      );\n      return Promise.all(promises).then((requests) => {\n        const data = requests?.[0]?.map(({ actions, ...request }) => ({\n          ...request,\n          updated:\n            actions?.length > 0 ? actions.pop()?.created_at : request.created_at\n        }));\n        return { data: data || [] };\n      });\n    });\n\nexport const getOrderProvisionItems = async (\n  orderId: string\n): Promise<OrderProvisionPayload> => {\n  const items = await fetchOrderProvisionItems(orderId);\n  return items;\n};\n\nexport const getProgressMessages = (\n  orderItemId: string\n): Promise<{\n  data: ProgressMessage[];\n}> =>\n  axiosInstance\n    .get(`${CATALOG_API_BASE}/order_items/${orderItemId}/progress_messages/`)\n    .then(({ data }: { data: Full<ProgressMessage>[] }) => {\n      return { data: data || [] };\n    });\n","import { addNotification } from '@redhat-cloud-services/frontend-components-notifications/redux';\n\nimport * as ActionTypes from '../action-types';\nimport * as OrderHelper from '../../helpers/order/order-helper-s';\nimport OrderNotification from '../../presentational-components/order/order-notification';\nimport { defaultSettings } from '../../helpers/shared/pagination';\nimport {\n  ApprovalRequestStateEnum,\n  Order,\n  OrderItem,\n  OrderStateEnum,\n  Portfolio,\n  PortfolioItem,\n  ProgressMessage\n} from '@redhat-cloud-services/catalog-client';\nimport { AnyObject } from '@data-driven-forms/react-form-renderer';\nimport { Dispatch } from 'redux';\nimport { Full, StringObject, ReduxAction } from '../../types/common-types';\nimport { ApiCollectionResponse } from '../../types/common-types-s';\nimport { AsyncMiddlewareAction, GetReduxState } from '../../types/redux';\nimport { Source } from '@redhat-cloud-services/sources-client';\nimport {\n  ObjectNotFound,\n  ProgressMessageItem\n} from '../../helpers/order/new-order-helper';\nimport { GetOrderDetailParams } from '../../helpers/order/order-helper';\nimport {\n  getServicePlans,\n  ServicePlan\n} from '../../helpers/order/service-plan-helper-s';\nimport React from 'react';\n\nexport const fetchServicePlans = (\n  portfolioItemId: string\n): AsyncMiddlewareAction<ApiCollectionResponse<ServicePlan>> => ({\n  type: ActionTypes.FETCH_SERVICE_PLANS,\n  payload: getServicePlans(portfolioItemId)\n});\n\nexport const setSelectedPlan = (\n  data: ServicePlan\n): ReduxAction<ServicePlan> => ({\n  type: ActionTypes.SET_SELECTED_PLAN,\n  payload: data\n});\n\nexport const sendSubmitOrder = (\n  apiProps: AnyObject,\n  portfolioItem: Full<PortfolioItem>\n) => (dispatch: Dispatch): AsyncMiddlewareAction =>\n  dispatch({\n    type: ActionTypes.SUBMIT_SERVICE_ORDER,\n    payload: OrderHelper.sendSubmitOrder(apiProps, portfolioItem).then(\n      ({ id, orderItem }) =>\n        dispatch(\n          addNotification({\n            variant: 'success',\n            title: 'Your order has been accepted successfully',\n            description: (\n              <OrderNotification\n                id={id!}\n                dispatch={dispatch}\n                portfolioItemId={portfolioItem.id}\n                portfolioId={portfolioItem.portfolio_id}\n                platformId={portfolioItem.service_offering_source_ref}\n                orderItemId={orderItem.id!}\n              />\n            ),\n            dismissable: true\n          })\n        )\n    )\n  });\n\nexport const cancelOrder = (orderId: string) => (\n  dispatch: Dispatch,\n  getState: GetReduxState\n): Promise<void | { type: string }> => {\n  dispatch({ type: `${ActionTypes.CANCEL_ORDER}_PENDING` });\n  const {\n    orderReducer: { orderDetail }\n  } = getState();\n  return OrderHelper.cancelOrder(orderId)\n    .then(() => {\n      orderDetail.order.state = OrderStateEnum.Canceled;\n      if (\n        orderDetail.approvalRequest &&\n        orderDetail.approvalRequest.data.length > 0\n      ) {\n        orderDetail.approvalRequest.data[0].state = 'canceled' as ApprovalRequestStateEnum;\n      }\n\n      dispatch({\n        type: ActionTypes.SET_ORDER_DETAIL,\n        payload: { ...orderDetail }\n      });\n      return orderDetail;\n    })\n    .then((orderDetail) =>\n      dispatch(\n        addNotification({\n          variant: 'success',\n          title: 'Your order has been canceled successfully',\n          description: `${`Order #${orderDetail.order.id}`} was canceled.`,\n          dismissable: true\n        })\n      )\n    )\n    .then(() => dispatch({ type: `${ActionTypes.CANCEL_ORDER}_FULFILLED` }))\n    .catch((error) => {\n      dispatch({\n        type: `${ActionTypes.CANCEL_ORDER}_REJECTED`,\n        payload: error\n      });\n    });\n};\n\nexport const fetchOrders = (\n  filters: StringObject,\n  pagination = defaultSettings\n) => (dispatch: Dispatch): Promise<ReduxAction> => {\n  let queryFilter = Object.entries(filters)\n    .filter(([, value]) => value && value.length > 0)\n    .map(([key, value]) =>\n      Array.isArray(value)\n        ? value.map((value) => `${key}=${value}`).join('&')\n        : `${key}=${value}`\n    )\n    .join('&');\n  if (pagination.sortBy) {\n    queryFilter = `${queryFilter}&sort_by=${\n      pagination.sortBy\n    }:${pagination.sortDirection || 'desc'}`;\n  }\n\n  dispatch({ type: `${ActionTypes.FETCH_ORDERS}_PENDING` });\n  return OrderHelper.getOrders(queryFilter, pagination)\n    .then(({ ...orders }) => {\n      return dispatch({\n        type: `${ActionTypes.FETCH_ORDERS}_FULFILLED`,\n        meta: {\n          ...pagination,\n          filter: queryFilter,\n          filters,\n          storeState: true,\n          stateKey: 'orders'\n        },\n        payload: orders\n      });\n    })\n    .catch((error) => {\n      return dispatch({\n        type: `${ActionTypes.FETCH_ORDERS}_REJECTED`,\n        payload: error\n      });\n    });\n};\n\nexport const fetchOrderDetails = (params: GetOrderDetailParams) => (\n  dispatch: Dispatch\n): Promise<{\n  type: string;\n  payload: {\n    order: Order | ObjectNotFound;\n    orderItem: OrderItem | ObjectNotFound;\n    portfolioItem: PortfolioItem | ObjectNotFound;\n    platform: Source | ObjectNotFound;\n    progressMessages: ProgressMessage | ObjectNotFound;\n    portfolio: Portfolio | ObjectNotFound;\n  };\n}> => {\n  dispatch({ type: `${ActionTypes.SET_ORDER_DETAIL}_PENDING` });\n  // @ts-ignore\n  return OrderHelper.getOrderDetail(params)\n    .then(\n      ([\n        order,\n        orderItem,\n        portfolioItem,\n        platform,\n        progressMessages,\n        portfolio\n      ]) =>\n        dispatch({\n          type: `${ActionTypes.SET_ORDER_DETAIL}_FULFILLED`,\n          payload: {\n            order,\n            orderItem,\n            portfolioItem,\n            platform,\n            progressMessages,\n            portfolio\n          }\n        })\n    )\n    .catch((error) =>\n      dispatch({\n        type: `${ActionTypes.SET_ORDER_DETAIL}_REJECTED`,\n        payload: error\n      })\n    );\n};\n\nexport const fetchApprovalRequests = (orderItemId: string) => (\n  dispatch: Dispatch\n): Promise<\n  | {\n      data: {\n        group_name: string;\n        decision: string;\n        updated?: string | undefined;\n      }[];\n    }\n  | { type: string; payload: any } /** the action in catch branch */\n> => {\n  dispatch({ type: `${ActionTypes.FETCH_APPROVAL_REQUESTS}_PENDING` });\n  return OrderHelper.getApprovalRequests(orderItemId)\n    .then((data) => {\n      dispatch({\n        type: `${ActionTypes.FETCH_APPROVAL_REQUESTS}_FULFILLED`,\n        payload: data\n      });\n      return data;\n    })\n    .catch((err) =>\n      dispatch({\n        type: `${ActionTypes.FETCH_APPROVAL_REQUESTS}_REJECTED`,\n        payload: err\n      })\n    );\n};\n\nexport const fetchOrderProvision = (orderId: string) => (\n  dispatch: Dispatch\n): Promise<{\n  type: string;\n  payload: {\n    orderItems: OrderItem[] | [];\n    progressMessageItems: ProgressMessageItem[] | [];\n  };\n}> => {\n  dispatch({ type: `${ActionTypes.SET_ORDER_PROVISION_ITEMS}_PENDING` });\n  // @ts-ignore\n  return OrderHelper.getOrderProvisionItems(orderId)\n    .then(({ orderItems, progressMessageItems }) =>\n      dispatch({\n        type: `${ActionTypes.SET_ORDER_PROVISION_ITEMS}_FULFILLED`,\n        payload: {\n          orderItems,\n          progressMessageItems\n        }\n      })\n    )\n    .catch((error) =>\n      dispatch({\n        type: `${ActionTypes.SET_ORDER_PROVISION_ITEMS}_REJECTED`,\n        payload: error\n      })\n    );\n};\n"],"names":["sendSubmitOrder","portfolioItem","service_parameters","providerControlParameters","parameters","post","order","orderItem","count","provider_control_parameters","id","name","portfolio_item","orderItemResponse","then","fetchServicePlans","portfolioItemId","type","payload","apiProps","dispatch","variant","title","description","portfolioId","portfolio_id","platformId","service_offering_source_ref","orderItemId","dismissable","fetchOrders","filters","pagination","queryFilter","Object","entries","filter","value","length","map","key","Array","isArray","join","sortBy","sortDirection","get","limit","offset","orders","console","log","orderIds","results","orderId","orderItems","itemIds","itemId","portfolioItems","data","orderObj","meta","storeState","stateKey","catch","error"],"sourceRoot":""}