{"version":3,"file":"js/9827.4f771f5f6d1cd9cbc85a.js","mappings":"wMAYMA,GAAgB,UAUTC,IATI,UAAoB,KASN,SAACC,GAC9B,OAAOF,EAAcG,MAChB,KAAgB,YAAYD,EAAU,eAIhCE,EAAmB,SAC9BF,EACAG,EACAC,GAEA,GAAIJ,EAAY,CACd,IAAMK,EAAcF,EAAS,SAASA,EAAW,GAC3CG,EAAeF,EACjB,aAAaA,EAAQG,MAAK,UAASH,EAAQI,QAAU,GACrD,GACJ,OAAOV,EAAcW,IAChB,KAAgB,YAAYT,EAAU,sBAAsBK,GAC7DF,EAAS,IAAM,KACdG,GAGL,OAAOR,EAAcW,IAAO,KAAgB,wBAInCC,EAAyB,SACpCV,EACAG,EACAC,GAEA,QAHA,IAAAD,IAAAA,EAAA,SACA,IAAAC,IAAAA,EAAU,MAENJ,EAAY,CACd,IAAMK,EAAcF,EAAS,QAAQA,EAAW,GAChD,OAAOL,EAAcW,IAChB,KAAgB,YAAYT,EAAU,yBAAyBK,GAChED,EAAU,cAAcA,EAAQG,MAAK,UAASH,EAAQI,QAAU,GAAM,KAI1E,OAAOV,EAAcW,IAChB,KAAgB,mCACjBL,EAAQG,MAAK,UACNH,EAAQI,QAAU,K,0NCnDpBG,EAAiB,WAAM,gBAClCC,GAGA,OADAA,EAAS,CAAEC,KAAS,KAA2B,aDA/Cf,EAAcW,IAAO,KAAgB,aCElCK,MAAK,SAACC,GACL,OAAAH,EAAS,CACPC,KAAS,KAA2B,aACpCG,QAASD,OAGZE,OAAM,SAACC,GACN,OAAAN,EAAS,CACPC,KAAS,KAA2B,YACpCG,QAASE,SAKJC,EAAqB,SAChCnB,EACAG,EACAC,GACkE,OAClES,KAAM,KACNG,QAAS,EAAgChB,EAAYG,EAAQC,GAC7DgB,KAAM,EAAF,CACFpB,WAAU,EACVG,OAAM,GACHC,KA+BMiB,EAAwB,SACnCC,GACkC,OAClCT,KAAM,KACNG,SD3D0BhB,EC2DUsB,ED1D7BxB,EAAcW,IAAO,KAAgB,YAAYT,EAAU,OADzC,IAACA,GC8DfuB,EAA2B,SACtCvB,EACAG,EACAC,GACmE,OACnES,KAAM,KACNG,QAAS,EAAsChB,EAAYG,EAAQC,KAGxD,EAAkB,SAACJ,GAAuB,gBACrDY,GAEA,OAAOA,EAAS,CACdC,KAAM,KACNG,QAAS,EAA+BhB,GACrCc,MAAK,WACJ,OAAAF,GACE,QAAgB,CACdY,QAAS,UACTC,MAAO,wCACPC,aAAa,EACbC,YAAa,kDAIlBV,OAAM,SAACC,GACe,MAAjBA,EAAMU,OACRhB,GACE,QAAgB,CACdY,QAAS,OACTC,MAAO,+BACPC,aAAa,EACbC,YAAa,uCAIjBf,EAAS,CACPC,KAAS,KAA4B,YACrCG,QAASE","sources":["webpack:///./src/helpers/platform/platform-helper-s.ts","webpack:///./src/redux/actions/platform-actions-s.ts"],"sourcesContent":["import { getAxiosInstance, getGraphqlInstance } from '../shared/user-login';\nimport {\n  CATALOG_API_BASE,\n  CATALOG_INVENTORY_API_BASE\n} from '../../utilities/constants';\nimport { defaultSettings, PaginationConfiguration } from '../shared/pagination';\nimport {\n  Source,\n  ServiceOffering,\n  ServiceInventory\n} from '@redhat-cloud-services/sources-client';\nimport { ApiCollectionResponse, SourceDetails } from '../../types/common-types';\nconst axiosInstance = getAxiosInstance();\nconst { post } = getGraphqlInstance();\n\nexport const getPlatforms = (): Promise<SourceDetails> =>\n  axiosInstance.get(`${CATALOG_API_BASE}/sources/`);\n\nexport const getPlatform = (platformId: string): Promise<Source> => {\n  return axiosInstance.get(`${CATALOG_API_BASE}/sources/${platformId}/`);\n};\n\nexport const refreshPlatform = (platformId: string): Promise<Source> => {\n  return axiosInstance.patch(\n    `${CATALOG_API_BASE}/sources/${platformId}/refresh/`\n  );\n};\n\nexport const getPlatformItems = (\n  platformId: string,\n  filter?: string,\n  options?: PaginationConfiguration\n): Promise<ApiCollectionResponse<ServiceOffering>> => {\n  if (platformId) {\n    const filterQuery = filter ? `?name=${filter}` : '';\n    const optionsQuery = options\n      ? `page_size=${options.limit}&page=${options.offset || 1}`\n      : '';\n    return axiosInstance.get(\n      `${CATALOG_API_BASE}/sources/${platformId}/service_offerings/${filterQuery}${\n        filter ? '&' : '?'\n      }${optionsQuery}`\n    );\n  } else {\n    return axiosInstance.get(`${CATALOG_API_BASE}/service_offerings/`);\n  }\n};\n\nexport const getPlatformInventories = (\n  platformId: string,\n  filter = '',\n  options = defaultSettings\n): Promise<ApiCollectionResponse<ServiceInventory>> => {\n  if (platformId) {\n    const filterQuery = filter ? `name=${filter}` : '';\n    return axiosInstance.get(\n      `${CATALOG_API_BASE}/sources/${platformId}/service_inventories/?${filterQuery}${\n        options ? `&page_size=${options.limit}&page=${options.offset || 1}` : ''\n      }`\n    );\n  } else {\n    return axiosInstance.get(\n      `${CATALOG_API_BASE}/service_inventories/?page_size=${\n        options.limit\n      }&page=${options.offset || 1}`\n    );\n  }\n};\n","import * as ActionTypes from '../action-types';\nimport * as PlatformHelper from '../../helpers/platform/platform-helper-s';\nimport { Dispatch } from 'redux';\nimport {\n  ServiceInventory,\n  ServiceOffering,\n  Source\n} from '@redhat-cloud-services/sources-client';\nimport { AsyncMiddlewareAction } from '../../types/redux';\nimport { ApiCollectionResponse, SourceDetails } from '../../types/common-types';\nimport { PaginationConfiguration } from '../../helpers/shared/pagination';\nimport { addNotification } from '@redhat-cloud-services/frontend-components-notifications/redux';\n\nexport const fetchPlatforms = () => (\n  dispatch: Dispatch\n): Promise<{ type: string; payload: SourceDetails }> => {\n  dispatch({ type: `${ActionTypes.FETCH_PLATFORMS}_PENDING` });\n  return PlatformHelper.getPlatforms()\n    .then((results) =>\n      dispatch({\n        type: `${ActionTypes.FETCH_PLATFORMS}_FULFILLED`,\n        payload: results\n      })\n    )\n    .catch((error) =>\n      dispatch({\n        type: `${ActionTypes.FETCH_PLATFORMS}_REJECTED`,\n        payload: error\n      })\n    );\n};\n\nexport const fetchPlatformItems = (\n  platformId: string,\n  filter: string,\n  options: PaginationConfiguration\n): AsyncMiddlewareAction<ApiCollectionResponse<ServiceOffering>> => ({\n  type: ActionTypes.FETCH_PLATFORM_ITEMS,\n  payload: PlatformHelper.getPlatformItems(platformId, filter, options),\n  meta: {\n    platformId,\n    filter,\n    ...options\n  }\n});\n\nexport const fetchMultiplePlatformItems = (\n  platformsId: string[]\n): {\n  type: string;\n  payload: Promise<\n    [] | { [x: string]: ApiCollectionResponse<ServiceOffering> }\n  >;\n} => {\n  const platformPromisses = platformsId.map((platformId) =>\n    PlatformHelper.getPlatformItems(platformId).then((results) => ({\n      [platformId]: results\n    }))\n  );\n  return {\n    type: ActionTypes.FETCH_MULTIPLE_PLATFORM_ITEMS,\n    payload: Promise.all(platformPromisses).then((results) =>\n      results.reduce(\n        (acc, curr) => ({\n          ...acc,\n          ...curr\n        }),\n        {}\n      )\n    )\n  };\n};\n\nexport const fetchSelectedPlatform = (\n  id: string\n): AsyncMiddlewareAction<Source> => ({\n  type: ActionTypes.FETCH_PLATFORM,\n  payload: PlatformHelper.getPlatform(id)\n});\n\nexport const fetchPlatformInventories = (\n  platformId: string,\n  filter: string,\n  options: PaginationConfiguration\n): AsyncMiddlewareAction<ApiCollectionResponse<ServiceInventory>> => ({\n  type: ActionTypes.FETCH_PLATFORM_INVENTORIES,\n  payload: PlatformHelper.getPlatformInventories(platformId, filter, options)\n});\n\nexport const refreshPlatform = (platformId: string) => (\n  dispatch: Dispatch\n): AsyncMiddlewareAction => {\n  return dispatch({\n    type: ActionTypes.REFRESH_PLATFORM,\n    payload: PlatformHelper.refreshPlatform(platformId)\n      .then(() =>\n        dispatch(\n          addNotification({\n            variant: 'success',\n            title: 'Success starting the platform refresh',\n            dismissable: true,\n            description: 'The platform refresh started successfully'\n          })\n        )\n      )\n      .catch((error) => {\n        if (error.status === 429) {\n          dispatch(\n            addNotification({\n              variant: 'info',\n              title: 'Platform refresh in progress',\n              dismissable: true,\n              description: 'Platform refresh already running.'\n            })\n          );\n        } else {\n          dispatch({\n            type: `${ActionTypes.REFRESH_PLATFORM}_REJECTED`,\n            payload: error\n          });\n        }\n      })\n  });\n};\n"],"names":["axiosInstance","refreshPlatform","platformId","patch","getPlatformItems","filter","options","filterQuery","optionsQuery","limit","offset","get","getPlatformInventories","fetchPlatforms","dispatch","type","then","results","payload","catch","error","fetchPlatformItems","meta","fetchSelectedPlatform","id","fetchPlatformInventories","variant","title","dismissable","description","status"],"sourceRoot":""}