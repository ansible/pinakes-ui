"use strict";(self.webpackChunkcatalog=self.webpackChunkcatalog||[]).push([[2391],{92558:(e,t,r)=>{r.r(t),r.d(t,{default:()=>ie});var o=r(87462),n=r(29439),a=r(4942),i=r(30624),l=r.n(i),c=r(45237),s=r(334),p=r(20777),u=r(48794),d=r(6202),f=r(63035),m=r(59837),y=r(7247),h=r(89231),v=r(77503),g=r(90459),b=r(15040),Z=r(62410),E=r(95645);const w=function(e){var t=e.id,r=e.to,o=e.portfolioName,n=e.portfolio_items,a=e.headerActions,i=void 0===a?[]:a;return l().createElement(g.$h,null,l().createElement(g.Gh,null,l().createElement(b.TextContent,null,l().createElement(s.Link,{to:r,id:"portfolio-link-"+t},l().createElement(b.Text,{title:o,className:"pf-u-mb-0",component:b.TextVariants.h3},l().createElement(E.Z,null,o))))),l().createElement(b.Badge,{isRead:!0},n),l().createElement("div",{onClick:function(e){return e.preventDefault()}},i))};var O=r(20697),D=r(36722),P=r(52587),F=r(92156),C=r(7579),k=r(56682),j=r(23349),S=r(29751),_=r(35388),T=function(){return(T=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},R=["description"],I=function(e){var t=e.portfolioId,r=e.handleCopyPortfolio,o=e.canLinkOrderProcesses,n=e.userCapabilities,a=n.share,c=n.copy,s=n.unshare,p=n.update,u=n.destroy,d=n.set_approval,f=(0,j.Z)(),m=(0,i.useState)(!1),y=m[0],h=m[1],v=[];if((a||s)&&v.push(l().createElement(b.DropdownItem,{key:"share-portfolio-action",id:"share-portfolio-action",component:l().createElement(O.Z,{searchParams:{portfolio:t},pathname:D.Ak,preserveHash:!0},f(C.Z.share))})),c&&v.push(l().createElement(b.DropdownItem,{key:"copy-portfolio-action",id:"copy-portfolio-action",onClick:function(){return r(t)}},f(C.Z.copy))),d&&v.push(l().createElement(b.DropdownItem,{key:"workflow-portfolio-action",id:"workflow-portfolio-action",component:l().createElement(O.Z,{searchParams:{portfolio:t},pathname:D.sP,preserveHash:!0},f(C.Z.setApproval))})),p&&o){var g=f(S.Z.setOrderProcess);v.push(l().createElement(b.DropdownItem,{"aria-label":g,key:"attach-order-processes",id:"attach-order-processes",component:l().createElement(O.Z,{preserveSearch:!0,pathname:D.yI,searchParams:{portfolio:t}},g),role:"link"}))}return p&&v.push(l().createElement(b.DropdownItem,{key:"edit-portfolio-action",id:"edit-portfolio-action",component:l().createElement(O.Z,{searchParams:{portfolio:t},pathname:D.Po,preserveHash:!0},f(C.Z.edit))})),u&&v.push(l().createElement(b.DropdownItem,{key:"remove-portfolio-action",id:"remove-portfolio-action",component:l().createElement(O.Z,{searchParams:{portfolio:t},pathname:D.wN,preserveHash:!0},f(C.Z.delete))})),0===v.length?null:l().createElement(b.Dropdown,{key:"portfolio-dropdown",id:"portfolio-"+t+"-dropdown",isOpen:y,isPlain:!0,onSelect:function(){return h(!1)},position:b.DropdownPosition.right,toggle:l().createElement(b.KebabToggle,{id:"portfolio-"+t+"-toggle",onToggle:function(e){return h(e)}}),dropdownItems:v})};const q=function(e){var t,r,o,n,a=e.imageUrl,i=e.isDisabled,c=e.name,s=e.id,p=e.handleCopyPortfolio,u=e.metadata,d=e.canLinkOrderProcesses,f=function(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(r[o[n]]=e[o[n]])}return r}(e,["imageUrl","isDisabled","name","id","handleCopyPortfolio","metadata","canLinkOrderProcesses"]),m=(0,j.Z)(),y={pathname:D.hT,search:"?portfolio="+s},h=(null===(t=window.catalog)||void 0===t?void 0:t.standalone)?_.Do:(null==u?void 0:u.user_capabilities)||{},v=(null==u?void 0:u.statistics)||{},E=null!==(r=null==v?void 0:v.portfolio_items)&&void 0!==r?r:0,O=null!==(o=null==v?void 0:v.approval_processes)&&void 0!==o?o:0,C=null!==(n=null==v?void 0:v.shared_groups)&&void 0!==n?n:0;return l().createElement(P.x,{isDisabled:i},l().createElement(P.r,{ouiaId:"portfolio-"+s},l().createElement(b.CardHeader,null,l().createElement(w,{id:s,to:y,portfolioName:c,portfolio_items:E,headerActions:l().createElement(I,{portfolioId:s,userCapabilities:h,handleCopyPortfolio:p,canLinkOrderProcesses:d})})),l().createElement(F.k,null,l().createElement(b.TextContent,{className:"pf-u-mb-md"},l().createElement(b.Text,{component:b.TextVariants.small,className:"pf-u-mb-0"},"Last updated ",l().createElement(Z.Z,{date:f.updated_at||f.created_at,type:"relative"})),l().createElement(b.Text,{component:b.TextVariants.small},"by ",f.owner)),l().createElement(g.ZP,T({},T({name:c,imageUrl:a},f),{toDisplay:R}))),l().createElement(b.CardFooter,null,O>0&&l().createElement(b.Label,{variant:"filled",color:"grey"},m(k.Z.approvalProcessSet))," ",C>0&&l().createElement(b.Label,{variant:"filled",color:"grey"},m(k.Z.shared)))))};var x=r(33188),B=r(81624),L=r(77172),N=r(92183),A=r(72510),V=r(44058),H=r(97881),U=r(64466),W=r(41436),Y=r(20240),G=r(45697),K=r.n(G),$=r(66031);function z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}var J={name:k.Z.name,owner:k.Z.owner,sort_by:k.Z.sortBy},M={name:k.Z.name,owner:k.Z.owner,updated_at:k.Z.updated,created_at:k.Z.created},Q=function(e){var t=e.filters,r=e.stateDispatch,i=e.debouncedFilter,s=e.initialState,p=e.meta,u=e.filterType,f=e.handleFilterItems,m=e.sortDirection,y=e.handleSort,h=e.fetchPortfoliosWithState,v=e.isFetching,g=e.isFiltering,b=e.canCreate,Z=(0,c.useDispatch)(),E=(0,j.Z)();return null!=p&&p.noData?null:l().createElement($.Z,(0,o.Z)({},b?{dedicatedAction:l().createElement(O.Z,{pathname:"/portfolios/add-portfolio"},l().createElement(d.Button,{variant:"primary",id:"create-portfolio",ouiaId:"create-portfolio",type:"button"},E(k.Z.create)))}:{},{activeFiltersConfig:{filters:Object.entries(t).filter((function(e){var t=(0,n.Z)(e,2)[1];return t&&t.length>0})).map((function(e){var t=(0,n.Z)(e,2),r=t[0],o=t[1];return{category:E(J[r]),type:r,chips:Array.isArray(o)?o.map((function(e){return{name:e}})):[{name:"sort_by"===r?E(M[o]):o}]}})),onDelete:function(e,o,l){var c=(0,n.Z)(o,1)[0];if(l)return r({type:"replaceFilterChip",payload:s.filters}),i(s.filters,p,Z,(function(e){return r({type:"setFilteringFlag",payload:e})}));var u=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?z(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t);"state"===c.type?u[c.type]=u[c.type].filter((function(e){return e!==c.chips[0].name})):u[c.type]="",r({type:"replaceFilterChip",payload:u}),i(u,p,Z,(function(e){return r({type:"setFilteringFlag",payload:e})}))}},filterConfig:{onChange:function(e,t){return r({type:"setFilterType",payload:t})},value:u,items:[{filterValues:{value:t.name,onChange:function(e,t){return f(t)}},label:E(k.Z.name),value:"name"},{filterValues:{value:t.owner,onChange:function(e,t){return f(t)}},label:E(k.Z.owner),value:"owner"},{filterValues:{value:t.sort_by||"name",onChange:function(e,t){return f(t)},items:[{label:E(k.Z.name),value:"name"},{label:E(k.Z.owner),value:"owner"},{label:E(k.Z.created),value:"created_at"},{label:E(k.Z.updated),value:"updated_at"}]},placeholder:t.sort_by?E(M[t.sort_by]):E(k.Z.name),label:E(k.Z.sortBy),value:"sort_by",type:"radio"}]},sortByConfig:{direction:m,onSortChange:function(e,t){return y(t)}},pagination:(null==p?void 0:p.count)>0?l().createElement(L.Z,{isDisabled:v||g,meta:p,apiRequest:function(e,r){return Z(h(t,r))},isCompact:!0}):void 0}))};Q.propTypes={filters:K().shape({name:K().string.isRequired,owner:K().string.isRequired,sort_by:K().string}).isRequired,stateDispatch:K().func.isRequired,debouncedFilter:K().func.isRequired,initialState:K().shape({filters:K().shape((0,a.Z)({},K().string,K().any)).isRequired}).isRequired,meta:K().object,filterType:K().string.isRequired,handleFilterItems:K().func.isRequired,sortDirection:K().string.isRequired,handleSort:K().func.isRequired,fetchPortfoliosWithState:K().func.isRequired,isFetching:K().bool.isRequired,isFiltering:K().bool.isRequired,canCreate:K().bool};const X=Q;var ee=r(15811);function te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function re(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?te(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):te(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var oe=(0,B.Z)((function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y.he,o=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;n(!0),o(null!==(t=window.catalog)&&void 0!==t&&t.standalone?(0,v.Ec)(e,r):(0,h.Ec)(e,r)).then((function(){return n(!1)}))}),1e3),ne={isOpen:!1,isFetching:!0,isFiltering:!1,filterType:"name",filters:{name:"",owner:"",sort_by:void 0},sortDirection:W.SortByDirection.asc},ae=function(e,t){switch(t.type){case"setFetching":return re(re({},e),{},{isFetching:t.payload});case"setFilterValue":return re(re({},e),{},{filters:(r=t.payload,o=e.filterType,n=e.filters,re(re({},n),{},(0,a.Z)({},o,r)))});case"replaceFilterChip":return re(re({},e),{},{sortDirection:W.SortByDirection.asc,filters:t.payload});case"setFilteringFlag":return re(re({},e),{},{isFiltering:t.payload});case"setFilterType":return re(re({},e),{},{filterType:t.payload});case"setSortBy":return re(re({},e),{},{sortDirection:t.payload,filters:e.filters.sort_by?e.filters:re(re({},e.filters),{},{sort_by:"name"})})}var r,o,n;return e};const ie=function(){var e,t=(0,j.Z)(),r=(0,V.Z)(),y=(0,Y.Z)(),g=(0,i.useReducer)(ae,re(re({},ne),null==r?void 0:r.portfolio)),b=(0,n.Z)(g,2),Z=b[0],E=Z.isFetching,w=Z.isFiltering,O=Z.filters,P=Z.filterType,F=Z.sortDirection,C=b[1],k=(0,c.useSelector)((function(e){return e.portfolioReducer.portfolios})),S=k.meta||{count:k.count},_=k.data||k.results,T=(0,c.useDispatch)(),R=(0,i.useContext)(A.Z).permissions,I=(0,s.useHistory)();(0,i.useEffect)((function(){var e;T(null!==(e=window.catalog)&&void 0!==e&&e.standalone?(0,v.Ec)(O,re(re({},S),{},{sortDirection:F})):(0,h.Ec)(O,re(re({},S),{},{sortDirection:F}))).then((function(){return C({type:"setFetching",payload:!1})})),(0,f.k3)()}),[]);var B=function(e){C({type:"setFilterValue",payload:e}),oe(re(re({},O),{},(0,a.Z)({},P,e)),re(re({},S),{},{offset:0,sortDirection:F}),T,(function(e){return C({type:"setFilteringFlag",payload:e})}))};(0,i.useEffect)((function(){!y||w&&E||B(O[P])}),[F]);var W=function(e){var t;return T(null!==(t=window.catalog)&&void 0!==t&&t.standalone?(0,v.Yh)(e):(0,h.Yh)(e)).then((function(e){var t=e.id;return I.push({pathname:D.hT,search:"?portfolio=".concat(t)})}))},G=(0,f.Fs)(R,["catalog:portfolios:create"]),K=(0,f.Fs)(R,["catalog:order_processes:link"]),$={PrimaryAction:null!=S&&S.noData?function(){return l().createElement(x._,{url:D.NP,id:"create-portfolio",label:"Create",hasPermission:G})}:function(){return l().createElement(d.Button,{ouiaId:"clear-filter",variant:"link",onClick:function(){return B("")}},t(H.Z.clearFilters))},title:null!=S&&S.noData?t(U.Z.portfoliosNoData):t(H.Z.noResults),description:null!=S&&S.noData?t(U.Z.portfoliosNoDataDescription):t(H.Z.noResultsDescription),Icon:null!=S&&S.noData?p.ZP:u.ZP},z=null==_?void 0:_.map((function(e){return l().createElement(q,(0,o.Z)({key:e.id,ouiaId:"portfolio-".concat(e.id)},e,{canLinkOrderProcesses:K,handleCopyPortfolio:W}))}));return l().createElement(i.Fragment,null,l().createElement(ee.Z,null,l().createElement(ee.y,{title:t(U.Z.portfoliosTitle)}),l().createElement(X,{filters:O,stateDispatch:C,debouncedFilter:oe,initialState:ne,meta:S,filterType:P,handleFilterItems:B,sortDirection:F,handleSort:function(e){return C({type:"setSortBy",payload:e})},fetchPortfoliosWithState:null!==(e=window.catalog)&&void 0!==e&&e.standalone?v.Ec:h.Ec,isFetching:E,isFiltering:w,canCreate:G})),l().createElement(m.Z,{items:z,isLoading:E||w,renderEmptyState:function(){return l().createElement(x.Z,$)}}),(null==S?void 0:S.count)>0&&l().createElement(N.Z,null,l().createElement(L.Z,{meta:S,apiRequest:function(e,t){var r;return T(null!==(r=window.catalog)&&void 0!==r&&r.standalone?(0,v.Ec)(O,t):(0,h.Ec)(O,t))},dropDirection:"up"})))}}}]);
//# sourceMappingURL=../sourcemaps/portfolios.e4356d0ace893387d23e87f9db59271c.js.map